# Examples å’Œ Tests å®¡æŸ¥æŠ¥å‘Š

## ğŸ“Š å®¡æŸ¥æ—¥æœŸ
2025-10-18

## ğŸ¯ å®¡æŸ¥ç›®æ ‡
æ£€æŸ¥ tests å’Œ examples ç›®å½•ä¸­æ˜¯å¦æœ‰ï¼š
1. è¿‡æ—¶çš„å¼•ç”¨
2. æ— ç”¨çš„æ–‡ä»¶
3. é‡å¤çš„åŠŸèƒ½

---

## âœ… Tests ç›®å½•å®¡æŸ¥

### æµ‹è¯•æ–‡ä»¶åˆ—è¡¨
```
tests/
â”œâ”€â”€ architecture_tests.rs          # V2 æ¶æ„æµ‹è¯•
â”œâ”€â”€ client_tests.rs                # å®¢æˆ·ç«¯æµ‹è¯•
â”œâ”€â”€ common/mod.rs                  # å…¬å…±æµ‹è¯•å·¥å…·
â”œâ”€â”€ error_tests.rs                 # é”™è¯¯å¤„ç†æµ‹è¯•
â”œâ”€â”€ openai_protocol_tests.rs       # OpenAI åè®®æµ‹è¯•
â”œâ”€â”€ protocol_provider_tests.rs     # åè®®/æä¾›å•†æµ‹è¯•
â”œâ”€â”€ protocol_tests.rs              # åè®®æµ‹è¯•
â”œâ”€â”€ streaming_integration_tests.rs # æµå¼é›†æˆæµ‹è¯•
â””â”€â”€ types_tests.rs                 # ç±»å‹æµ‹è¯•
```

### æµ‹è¯•çŠ¶æ€
```bash
cargo test --tests
# ç»“æœ: æ‰€æœ‰æµ‹è¯•é€šè¿‡ âœ…
```

### ç»“è®º
- âœ… æ‰€æœ‰æµ‹è¯•æ–‡ä»¶éƒ½æ˜¯å¿…è¦çš„
- âœ… æ²¡æœ‰è¿‡æ—¶çš„å¼•ç”¨
- âœ… æµ‹è¯•è¦†ç›–äº†æ ¸å¿ƒåŠŸèƒ½
- âœ… æ— éœ€åˆ é™¤ä»»ä½•æ–‡ä»¶

---

## ğŸ“ Examples ç›®å½•å®¡æŸ¥

### åŸºç¡€ç¤ºä¾‹ï¼ˆä¿ç•™ï¼‰

#### 1. å„æä¾›å•†åŸºç¡€ç¤ºä¾‹
- `openai_basic.rs` - OpenAI åŸºç¡€ç”¨æ³• âœ…
- `anthropic_streaming.rs` - Anthropic æµå¼ç¤ºä¾‹ âœ…
- `aliyun_basic.rs` - é˜¿é‡Œäº‘åŸºç¡€ç”¨æ³• âœ…
- `zhipu_basic.rs` - æ™ºè°±åŸºç¡€ç”¨æ³• âœ…
- `ollama_basic.rs` - Ollama åŸºç¡€ç”¨æ³• âœ…
- `tencent_basic.rs` - è…¾è®¯äº‘åŸºç¡€ç”¨æ³• âœ…

**ç”¨é€”**: å±•ç¤ºå„æä¾›å•†çš„åŸºæœ¬ä½¿ç”¨æ–¹æ³•

#### 2. æµå¼ç¤ºä¾‹
- `ollama_streaming.rs` - Ollama æµå¼ç¤ºä¾‹ âœ…
- `zhipu_streaming.rs` - æ™ºè°±æµå¼ç¤ºä¾‹ âœ…

**ç”¨é€”**: å±•ç¤ºæµå¼å“åº”çš„ä½¿ç”¨

#### 3. ç‰¹æ®ŠåŠŸèƒ½ç¤ºä¾‹
- `ollama_model_management.rs` - Ollama æ¨¡å‹ç®¡ç† âœ…

**ç”¨é€”**: å±•ç¤º Ollama ç‰¹æœ‰çš„æ¨¡å‹ç®¡ç†åŠŸèƒ½

---

### å·¥å…·è°ƒç”¨ç¤ºä¾‹ï¼ˆä¿ç•™ï¼‰

#### 1. åŸºç¡€å·¥å…·è°ƒç”¨
- `zhipu_tools.rs` - æ™ºè°±å·¥å…·è°ƒç”¨åŸºç¡€ç¤ºä¾‹ âœ…
- `zhipu_tools_streaming.rs` - æ™ºè°±å·¥å…·è°ƒç”¨æµå¼ç¤ºä¾‹ âœ…
- `zhipu_multiround_tools.rs` - æ™ºè°±å¤šè½®å·¥å…·è°ƒç”¨ âœ…

**ç”¨é€”**: å±•ç¤ºæ™ºè°±çš„å·¥å…·è°ƒç”¨åŠŸèƒ½

#### 2. è¾¹ç¼˜æƒ…å†µæµ‹è¯•
- `zhipu_tools_edge_cases.rs` - æ™ºè°±å·¥å…·è°ƒç”¨è¾¹ç¼˜æƒ…å†µ âœ…

**ç”¨é€”**: æµ‹è¯•ç‰¹æ®Šåœºæ™¯å’Œè¾¹ç¼˜æƒ…å†µ

---

### æµ‹è¯•å’ŒéªŒè¯ç¤ºä¾‹ï¼ˆä¿ç•™ - ç”¨äºå¼€å‘å’Œè°ƒè¯•ï¼‰

#### 1. å·¥å…·è°ƒç”¨ä¿®å¤éªŒè¯
- `verify_tool_fix.rs` - éªŒè¯ v0.4.14 çš„å·¥å…·è°ƒç”¨ä¿®å¤ âœ…

**ç”¨é€”**: éªŒè¯ OpenAI åè®®å·¥å…·è°ƒç”¨æ”¯æŒ

#### 2. æ™ºè°±æµå¼å“åº”æµ‹è¯•
- `test_zhipu_tool_streaming_issue.rs` - æµ‹è¯•æ™ºè°±æµå¼é—®é¢˜ âœ…
- `test_zhipu_tool_messages_detailed.rs` - è¯¦ç»†æµ‹è¯•æ™ºè°±æµå¼ âœ…
- `test_glm_models_tool_streaming.rs` - æµ‹è¯• GLM æ¨¡å‹æµå¼ âœ…

**ç”¨é€”**: éªŒè¯æ™ºè°± GLM åœ¨åŒ…å« Role::Tool æ—¶çš„æµå¼å“åº”

#### 3. å…¶ä»–æä¾›å•†å·¥å…·è°ƒç”¨æµ‹è¯•
- `test_deepseek_tools.rs` - DeepSeek å·¥å…·è°ƒç”¨æµ‹è¯• âœ…
- `test_openai_tool_streaming.rs` - OpenAI å·¥å…·è°ƒç”¨æµå¼æµ‹è¯• âœ…
- `test_all_providers_tool_streaming.rs` - æ‰€æœ‰æä¾›å•†æµ‹è¯• âœ…

**ç”¨é€”**: éªŒè¯å„æä¾›å•†çš„å·¥å…·è°ƒç”¨åŠŸèƒ½

---

## ğŸ” é‡å¤åŠŸèƒ½åˆ†æ

### æ™ºè°±å·¥å…·è°ƒç”¨ç¤ºä¾‹å¯¹æ¯”

| æ–‡ä»¶ | ç”¨é€” | æ˜¯å¦ä¿ç•™ |
|------|------|----------|
| `zhipu_tools.rs` | åŸºç¡€å·¥å…·è°ƒç”¨ç¤ºä¾‹ | âœ… ä¿ç•™ - ç”¨æˆ·æ–‡æ¡£ |
| `zhipu_tools_streaming.rs` | æµå¼å·¥å…·è°ƒç”¨ç¤ºä¾‹ | âœ… ä¿ç•™ - ç”¨æˆ·æ–‡æ¡£ |
| `zhipu_multiround_tools.rs` | å¤šè½®å¯¹è¯ç¤ºä¾‹ | âœ… ä¿ç•™ - ç”¨æˆ·æ–‡æ¡£ |
| `zhipu_tools_edge_cases.rs` | è¾¹ç¼˜æƒ…å†µæµ‹è¯• | âœ… ä¿ç•™ - å¼€å‘æµ‹è¯• |
| `test_zhipu_tool_streaming_issue.rs` | æµå¼é—®é¢˜éªŒè¯ | âœ… ä¿ç•™ - å¼€å‘æµ‹è¯• |
| `test_zhipu_tool_messages_detailed.rs` | è¯¦ç»†æµå¼æµ‹è¯• | âœ… ä¿ç•™ - å¼€å‘æµ‹è¯• |
| `test_glm_models_tool_streaming.rs` | GLM æ¨¡å‹æµ‹è¯• | âœ… ä¿ç•™ - å¼€å‘æµ‹è¯• |

**ç»“è®º**: è™½ç„¶æœ‰å¤šä¸ªæ™ºè°±ç›¸å…³ç¤ºä¾‹ï¼Œä½†å®ƒä»¬å„æœ‰ä¸åŒç”¨é€”ï¼š
- å‰ 3 ä¸ªæ˜¯ç”¨æˆ·æ–‡æ¡£ç¤ºä¾‹
- å 4 ä¸ªæ˜¯å¼€å‘æµ‹è¯•å·¥å…·

---

## ğŸ“‹ æ–‡ä»¶åˆ†ç±»

### ç”¨æˆ·æ–‡æ¡£ç¤ºä¾‹ï¼ˆ15 ä¸ªï¼‰
è¿™äº›ç¤ºä¾‹åº”è¯¥ä¿ç•™ï¼Œä½œä¸ºç”¨æˆ·å­¦ä¹ å’Œå‚è€ƒï¼š

1. `openai_basic.rs`
2. `anthropic_streaming.rs`
3. `aliyun_basic.rs`
4. `zhipu_basic.rs`
5. `zhipu_streaming.rs`
6. `zhipu_tools.rs`
7. `zhipu_tools_streaming.rs`
8. `zhipu_multiround_tools.rs`
9. `ollama_basic.rs`
10. `ollama_streaming.rs`
11. `ollama_model_management.rs`
12. `tencent_basic.rs`
13. `zhipu_tools_edge_cases.rs`
14. `README.md`

### å¼€å‘æµ‹è¯•å·¥å…·ï¼ˆ7 ä¸ªï¼‰
è¿™äº›ç¤ºä¾‹ç”¨äºå¼€å‘å’Œè°ƒè¯•ï¼Œå¯ä»¥ä¿ç•™ï¼š

1. `verify_tool_fix.rs` - éªŒè¯ä¿®å¤
2. `test_zhipu_tool_streaming_issue.rs` - é—®é¢˜è¯Šæ–­
3. `test_zhipu_tool_messages_detailed.rs` - è¯¦ç»†æµ‹è¯•
4. `test_glm_models_tool_streaming.rs` - æ¨¡å‹æµ‹è¯•
5. `test_deepseek_tools.rs` - DeepSeek æµ‹è¯•
6. `test_openai_tool_streaming.rs` - OpenAI æµ‹è¯•
7. `test_all_providers_tool_streaming.rs` - ç»¼åˆæµ‹è¯•

---

## âœ… æœ€ç»ˆç»“è®º

### æ— éœ€åˆ é™¤çš„æ–‡ä»¶
**æ‰€æœ‰æ–‡ä»¶éƒ½æœ‰å…¶å­˜åœ¨ä»·å€¼ï¼Œå»ºè®®å…¨éƒ¨ä¿ç•™ã€‚**

### ç†ç”±
1. **ç”¨æˆ·æ–‡æ¡£ç¤ºä¾‹**: å¸®åŠ©ç”¨æˆ·å¿«é€Ÿä¸Šæ‰‹å„ä¸ªåŠŸèƒ½
2. **å¼€å‘æµ‹è¯•å·¥å…·**: å¸®åŠ©å¼€å‘è€…éªŒè¯åŠŸèƒ½å’Œè¯Šæ–­é—®é¢˜
3. **æ— é‡å¤**: è™½ç„¶æœ‰å¤šä¸ªç›¸ä¼¼ç¤ºä¾‹ï¼Œä½†å®ƒä»¬æµ‹è¯•ä¸åŒçš„åœºæ™¯

### å»ºè®®
1. âœ… ä¿ç•™æ‰€æœ‰ç°æœ‰ç¤ºä¾‹
2. âœ… åœ¨ `examples/README.md` ä¸­æ·»åŠ åˆ†ç±»è¯´æ˜
3. âœ… æ ‡æ³¨å“ªäº›æ˜¯ç”¨æˆ·æ–‡æ¡£ï¼Œå“ªäº›æ˜¯å¼€å‘å·¥å…·

---

## ğŸ”§ å·²ä¿®å¤çš„é—®é¢˜

### 1. ç¼–è¯‘é”™è¯¯
- âœ… ç§»é™¤ä¸å­˜åœ¨çš„ `openrouter` æ–¹æ³•è°ƒç”¨
- âœ… ä¿®å¤ tool_calls å¼•ç”¨ç±»å‹é—®é¢˜

### 2. è­¦å‘Š
- âœ… æ·»åŠ  `#[allow(dead_code)]` æ¶ˆé™¤æœªä½¿ç”¨å­—æ®µè­¦å‘Š
- âœ… ä¿®å¤æœªä½¿ç”¨å¯¼å…¥è­¦å‘Šï¼ˆå°†å¯¼å…¥ç§»åˆ° `#[cfg(feature = "streaming")]` å†…ï¼‰
- âœ… ä¿®å¤ clippy è­¦å‘Šï¼ˆç©ºè¡Œå’Œé•¿åº¦æ¯”è¾ƒï¼‰

### 3. ä»£ç è´¨é‡
- âœ… æ‰€æœ‰ç¤ºä¾‹éƒ½èƒ½æ­£å¸¸ç¼–è¯‘
- âœ… æ‰€æœ‰æµ‹è¯•éƒ½èƒ½é€šè¿‡
- âœ… æ— è¿‡æ—¶çš„å¼•ç”¨

---

## ğŸ“Š ç»Ÿè®¡

- **æµ‹è¯•æ–‡ä»¶**: 9 ä¸ª âœ…
- **ç”¨æˆ·ç¤ºä¾‹**: 14 ä¸ª âœ…
- **å¼€å‘å·¥å…·**: 7 ä¸ª âœ…
- **æ€»è®¡**: 30 ä¸ªæ–‡ä»¶

**çŠ¶æ€**: å…¨éƒ¨ä¿ç•™ï¼Œæ— éœ€åˆ é™¤ âœ…

---

**å®¡æŸ¥å®Œæˆæ—¶é—´**: 2025-10-18  
**å®¡æŸ¥äºº**: AI Assistant  
**ç»“è®º**: âœ… æ‰€æœ‰æ–‡ä»¶éƒ½æœ‰ä»·å€¼ï¼Œå»ºè®®ä¿ç•™

